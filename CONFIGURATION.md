# Configuration Centralis√©e

Ce projet utilise une configuration centralis√©e pour faciliter la maintenance et les d√©ploiements.

## üìÅ Structure des fichiers de configuration

```
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js          # Configuration des endpoints API
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ environment.js  # Variables d'environnement
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apiService.js   # Service API centralis√©
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useTheme.js     # Hook personnalis√© pour la gestion des th√®mes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ themeInit.js    # Utilitaires d'initialisation des th√®mes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ themes.css      # Variables CSS pour les th√®mes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ variables.css   # Variables CSS globales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/         # Composants de mise en page
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Dashboard.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/             # Composants d'interface utilisateur
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoadingSpinner.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoadingSpinner.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ThemeToggle.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ThemeToggle.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modals/         # Composants modaux
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginModal.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginModal.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NotificationModal.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotificationModal.css
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pages/          # Composants de pages
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ DashboardHome.jsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ DashboardHome.css
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ PasswordResetPage.jsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ PasswordResetPage.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ img/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ logo.png
‚îÇ   ‚îî‚îÄ‚îÄ .env                    # Variables d'environnement frontend
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings.py         # Configuration Django centralis√©e
‚îÇ   ‚îî‚îÄ‚îÄ .env                    # Variables d'environnement backend
‚îú‚îÄ‚îÄ start-maildev.bat           # Script pour d√©marrer MailDev
‚îú‚îÄ‚îÄ start-maildev.ps1           # Script PowerShell pour MailDev
‚îî‚îÄ‚îÄ CONFIGURATION.md            # Ce fichier
```

## üé® Syst√®me de Th√®mes

### Configuration des th√®mes

Le projet utilise un syst√®me de th√®mes bas√© sur les variables CSS avec deux th√®mes disponibles :

- **Th√®me sombre** (par d√©faut) : Interface sombre avec accents bleus
- **Th√®me clair** : Interface claire avec sidebar bleue et texte blanc

### Fichiers de configuration des th√®mes

#### `frontend/src/styles/themes.css`

D√©finit toutes les variables CSS pour les deux th√®mes :

```css
:root {
	/* Th√®me sombre */
	--theme-dark-primary: #1e3a8a;
	--theme-dark-secondary: #1e40af;
	--theme-dark-text: #ffffff;
	/* ... autres variables */

	/* Th√®me clair */
	--theme-light-primary: #1e40af;
	--theme-light-secondary: #1e40af;
	--theme-light-text: #ffffff;
	/* ... autres variables */
}
```

#### `frontend/src/hooks/useTheme.js`

Hook React personnalis√© pour la gestion des th√®mes :

```javascript
const useTheme = () => {
	const [theme, setTheme] = useState("dark");

	const toggleTheme = () => {
		const newTheme = theme === "dark" ? "light" : "dark";
		setTheme(newTheme);
		document.documentElement.setAttribute("data-theme", newTheme);
		localStorage.setItem("theme", newTheme);
	};

	return {
		theme,
		toggleTheme,
		isDark: theme === "dark",
		isLight: theme === "light",
	};
};
```

#### `frontend/src/utils/themeInit.js`

Utilitaires pour l'initialisation des th√®mes :

```javascript
export const initializeTheme = () => {
	const savedTheme = localStorage.getItem("theme") || "dark";
	document.documentElement.setAttribute("data-theme", savedTheme);
	document.documentElement.classList.add("theme-loaded");
	return savedTheme;
};
```

### Utilisation dans les composants

```javascript
import useTheme from "../../hooks/useTheme";

const MyComponent = () => {
	const { theme, toggleTheme, isDark } = useTheme();

	return (
		<button onClick={toggleTheme}>
			{isDark ? "Mode clair" : "Mode sombre"}
		</button>
	);
};
```

## üìÅ Organisation des Composants Frontend

### Structure par cat√©gories

Les composants frontend sont organis√©s en dossiers logiques pour une meilleure maintenabilit√© :

#### `layout/` - Composants de mise en page

- **Sidebar.jsx/css** : Barre lat√©rale avec navigation et s√©lecteur de th√®me
- **Dashboard.jsx/css** : Layout principal du tableau de bord

#### `ui/` - Composants d'interface utilisateur

- **Button.jsx/css** : Boutons personnalisables
- **LoadingSpinner.jsx/css** : Indicateur de chargement
- **ThemeToggle.jsx/css** : S√©lecteur de th√®me

#### `modals/` - Composants modaux

- **LoginModal.jsx/css** : Modal de connexion et r√©initialisation de mot de passe
- **NotificationModal.jsx/css** : Modal de notifications

#### `pages/` - Composants de pages

- **DashboardHome.jsx/css** : Page d'accueil du tableau de bord
- **PasswordResetPage.jsx/css** : Page de confirmation de r√©initialisation

### Mise √† jour des imports

Tous les imports ont √©t√© mis √† jour pour refl√©ter la nouvelle structure :

```javascript
// Avant
import Sidebar from "../components/Sidebar";
import Button from "../components/Button";

// Apr√®s
import Sidebar from "../components/layout/Sidebar";
import Button from "../components/ui/Button";
```

### Avantages de cette organisation

- **Maintenabilit√©** : Composants regroup√©s par fonction
- **Scalabilit√©** : Facilite l'ajout de nouveaux composants
- **Lisibilit√©** : Structure claire et intuitive
- **R√©utilisabilit√©** : S√©paration claire entre layout, UI et pages

## üîß Configuration Frontend

### Variables d'environnement (.env)

```env
# Configuration de l'API
VITE_API_URL=http://localhost:8000

# Configuration de l'application
VITE_APP_NAME=Gestion Marketing
VITE_APP_VERSION=1.0.0

# Fonctionnalit√©s
VITE_DEBUG_MODE=true
VITE_ENABLE_ANALYTICS=false
VITE_ENABLE_NOTIFICATIONS=true
```

### Utilisation dans le code

```javascript
import { API_ENDPOINTS } from "../config/api";
import { getConfig } from "../config/environment";
import { authService } from "../services/apiService";

// Utiliser un endpoint
const loginData = await authService.login(credentials);

// Obtenir une configuration
const apiUrl = getConfig("API_URL");
const debugMode = getConfig("FEATURES.DEBUG_MODE");
```

## üîß Configuration Backend

### Variables d'environnement (.env)

```env
# Environnement
ENVIRONMENT=development
SECRET_KEY=your-secret-key-here

# Base de donn√©es
DB_NAME=gestion_bd
DB_USER=root
DB_PASSWORD=your-password
DB_HOST=127.0.0.1
DB_PORT=3306

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Email (Production)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=noreply@gestion-marketing.com

# H√¥tes autoris√©s
ALLOWED_HOSTS=127.0.0.1,localhost
```

### Utilisation dans le code Django

```python
from config.settings import DATABASE_CONFIG, EMAIL_CONFIG, JWT_CONFIG

# Les configurations sont automatiquement appliqu√©es
```

## üìß Configuration Email avec MailDev

### Installation de MailDev

```bash
npm install -g maildev
```

### D√©marrage de MailDev

**Option 1 - Script batch :**

```bash
start-maildev.bat
```

**Option 2 - Script PowerShell :**

```powershell
.\start-maildev.ps1
```

**Option 3 - Commande directe :**

```bash
maildev
```

### Acc√®s √† l'interface MailDev

- **Interface web** : http://localhost:1080
- **Port SMTP** : 1025

### Configuration Django pour MailDev

La configuration est d√©j√† pr√™te dans `settings.py` :

```python
EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'localhost'
EMAIL_PORT = 1025
EMAIL_USE_TLS = False
EMAIL_USE_SSL = False
DEFAULT_FROM_EMAIL = 'noreply@gestion-marketing.com'
```

### Test des emails

1. **D√©marrer MailDev** : `maildev`
2. **D√©marrer Django** : `python manage.py runserver`
3. **Demander une r√©initialisation** dans l'interface
4. **V√©rifier MailDev** : http://localhost:1080

## üöÄ Avantages de cette approche

### ‚úÖ **Maintenance facilit√©e**

- Toutes les URLs sont centralis√©es dans un seul fichier
- Variables d'environnement organis√©es et document√©es
- Configuration par environnement (dev/prod)

### ‚úÖ **D√©ploiement simplifi√©**

- Changement d'URL d'API en un seul endroit
- Configuration automatique selon l'environnement
- Pas de hardcoding d'URLs

### ‚úÖ **D√©veloppement am√©lior√©**

- Services API r√©utilisables
- Gestion automatique des tokens
- Intercepteurs pour logging et gestion d'erreurs
- **MailDev pour tester les emails en d√©veloppement**

### ‚úÖ **S√©curit√© renforc√©e**

- Variables sensibles dans les fichiers .env
- Configuration de s√©curit√© par environnement
- Gestion automatique des CORS

## üìã Liste des endpoints disponibles

### Authentification

- `POST /api/accounts/login/` - Connexion
- `POST /api/accounts/signup/` - Inscription
- `POST /api/accounts/refresh/` - Rafra√Æchir token
- `POST /api/accounts/logout/` - D√©connexion
- `GET /api/accounts/me/` - Profil utilisateur
- `POST /api/accounts/password-reset-request/` - Demande r√©initialisation
- `POST /api/accounts/password-reset-confirm/` - Confirmation r√©initialisation

### Utilisateurs

- `GET /api/accounts/users/` - Liste utilisateurs
- `GET /api/accounts/users/{id}/` - D√©tails utilisateur
- `POST /api/accounts/users/` - Cr√©er utilisateur
- `PUT /api/accounts/users/{id}/` - Modifier utilisateur
- `DELETE /api/accounts/users/{id}/` - Supprimer utilisateur
- `POST /api/accounts/users/{id}/set_password/` - Changer mot de passe

### R√¥les et Permissions

- `GET /api/accounts/roles/` - Liste r√¥les
- `GET /api/accounts/permissions/` - Liste permissions
- `GET /api/accounts/services/` - Liste services
- `GET /api/accounts/role-permissions/` - Liste r√¥les-permissions

## üîÑ Migration vers la nouvelle configuration

### Frontend

1. Remplacer les appels axios directs par les services
2. Utiliser `getConfig()` pour les variables d'environnement
3. Utiliser `API_ENDPOINTS` pour les URLs

### Backend

1. Utiliser les configurations centralis√©es
2. Ajouter les variables d'environnement dans `.env`
3. Tester la configuration par environnement

## üõ†Ô∏è Ajout de nouveaux endpoints

### 1. Ajouter l'endpoint dans `frontend/src/config/api.js`

```javascript
// Dans API_CONFIG
NEW_FEATURE: {
  LIST: '/accounts/new-feature/',
  DETAIL: (id) => `/accounts/new-feature/${id}/`,
},

// Dans API_ENDPOINTS
NEW_FEATURE_LIST: buildApiUrl(API_CONFIG.NEW_FEATURE.LIST),
NEW_FEATURE_DETAIL: (id) => buildApiUrl(API_CONFIG.NEW_FEATURE.DETAIL(id)),
```

### 2. Ajouter le service dans `frontend/src/services/apiService.js`

```javascript
export const newFeatureService = {
	getNewFeatures: async () => {
		const response = await apiClient.get(API_ENDPOINTS.NEW_FEATURE_LIST);
		return response.data;
	},

	getNewFeature: async (id) => {
		const response = await apiClient.get(API_ENDPOINTS.NEW_FEATURE_DETAIL(id));
		return response.data;
	},
};
```

### 3. Utiliser le service dans les composants

```javascript
import { newFeatureService } from "../services/apiService";

const data = await newFeatureService.getNewFeatures();
```

Cette approche garantit une maintenance facile et une √©volution sereine du projet ! üéâ
